# Hibiji Platform - AWS URLs & Deployment Guide

## üåê **Environment URLs**

### **Base Domain**: `hibiji.com`

**AWS Region**: `us-west-1`

---

## üöÄ **Direct AWS URLs (No DNS Propagation Required)**

### **URL Pattern**

```
Application Load Balancer: hibiji-{sub-environment}-alb-{random-suffix}.us-west-1.elb.amazonaws.com
```

### **What the Placeholders Mean**

#### **`{sub-environment}`**

This is the specific environment identifier:

- `dev01`, `dev02`, `dev03` - Development environments
- `qa01`, `qa02`, `qa03` - QA environments
- `staging01`, `staging02`, `staging03` - Staging environments
- `prod01`, `prod02` - Production environments

#### **`{random-suffix}`**

This is a unique 8-character hexadecimal string generated by Terraform for resource uniqueness. Examples:

- `a1b2c3d4`
- `f5e6d7c8`
- `9a8b7c6d`

#### **`{alb-dns-name}`**

This is the complete Application Load Balancer DNS name. Example:

- `hibiji-dev01-alb-a1b2c3d4.us-west-1.elb.amazonaws.com`

---

## üìã **Complete Environment URLs**

### **Development Environments**

- **dev01**: `http://hibiji-dev01-alb-{suffix}.us-west-1.elb.amazonaws.com`
- **dev02**: `http://hibiji-dev02-alb-{suffix}.us-west-1.elb.amazonaws.com`
- **dev03**: `http://hibiji-dev03-alb-{suffix}.us-west-1.elb.amazonaws.com`

### **QA Environments**

- **qa01**: `http://hibiji-qa01-alb-{suffix}.us-west-1.elb.amazonaws.com`
- **qa02**: `http://hibiji-qa02-alb-{suffix}.us-west-1.elb.amazonaws.com`
- **qa03**: `http://hibiji-qa03-alb-{suffix}.us-west-1.elb.amazonaws.com`

### **Staging Environments**

- **staging01**: `http://hibiji-staging01-alb-{suffix}.us-west-1.elb.amazonaws.com`
- **staging02**: `http://hibiji-staging02-alb-{suffix}.us-west-1.elb.amazonaws.com`
- **staging03**: `http://hibiji-staging03-alb-{suffix}.us-west-1.elb.amazonaws.com`

### **Production Environments**

- **prod01**: `http://hibiji-prod01-alb-{suffix}.us-west-1.elb.amazonaws.com`
- **prod02**: `http://hibiji-prod02-alb-{suffix}.us-west-1.elb.amazonaws.com`

---

## üîß **Service Endpoints**

### **Backend API** (Port 80 - Default)

```
http://{alb-dns-name}/
```

**Example with actual values:**

```
http://hibiji-dev01-alb-a1b2c3d4.us-west-1.elb.amazonaws.com/
```

**Key Endpoints:**

- **Health Check**: `http://{alb-dns-name}/health`
- **API Documentation**: `http://{alb-dns-name}/docs`
- **Root Endpoint**: `http://{alb-dns-name}/`
- **Authentication**: `http://{alb-dns-name}/auth/*`

### **Frontend** (Port 3000)

```
http://{alb-dns-name}:3000/
```

**Example with actual values:**

```
http://hibiji-dev01-alb-a1b2c3d4.us-west-1.elb.amazonaws.com:3000/
```

---

## üèóÔ∏è **AWS Resource Names**

### **ECS Services**

- **Backend Service**: `hibiji-{environment}-backend`
- **Frontend Service**: `hibiji-{environment}-frontend`
- **Cluster**: `hibiji-{environment}-cluster`

**Examples:**

- Backend: `hibiji-dev01-backend`
- Frontend: `hibiji-dev01-frontend`
- Cluster: `hibiji-dev01-cluster`

### **Load Balancer Target Groups**

- **Backend Target Group**: `hibiji-bk-{suffix}`
- **Frontend Target Group**: `hibiji-fr-{suffix}`

**Examples:**

- Backend TG: `hibiji-bk-a1b2c3d4`
- Frontend TG: `hibiji-fr-a1b2c3d4`

### **VPC Resources**

- **VPC**: `hibiji-{sub-environment}-vpc`
- **Security Groups**: `hibiji-{sub-environment}-alb-sg`, `hibiji-{sub-environment}-app-sg`
- **Subnets**: `hibiji-{sub-environment}-public-1`, `hibiji-{sub-environment}-private-1`

---

## üîç **How to Find the Exact URLs**

### **Option 1: AWS Console**

1. Go to **EC2** ‚Üí **Load Balancers**
2. Look for load balancers named `hibiji-{environment}-alb`
3. Copy the **DNS name** from the **Description** tab

### **Option 2: AWS CLI**

```bash
# List all Hibiji load balancers
aws elbv2 describe-load-balancers --region us-west-1 \
  --query 'LoadBalancers[?contains(LoadBalancerName, `hibiji`)].{Name:LoadBalancerName,DNS:DNSName}' \
  --output table

# Get specific environment load balancer
aws elbv2 describe-load-balancers --region us-west-1 \
  --query 'LoadBalancers[?contains(LoadBalancerName, `hibiji-dev01`)].DNSName' \
  --output text
```

### **Option 3: Terraform Output**

Add this to your Terraform configuration:

```hcl
output "alb_dns_name" {
  value = aws_lb.main.dns_name
}

output "alb_name" {
  value = aws_lb.main.name
}
```

Then run:

```bash
terraform output alb_dns_name
```

### **Option 4: ECS Console**

1. Go to **ECS** ‚Üí **Clusters**
2. Select your cluster (e.g., `hibiji-dev01-cluster`)
3. Go to **Services** tab
4. Click on a service to see the **Load Balancer** configuration

---

## üìä **Environment Configuration**

### **Resource Sizing**

| Environment | Backend CPU | Backend Memory | Frontend CPU | Frontend Memory | Desired Count |
| ----------- | ----------- | -------------- | ------------ | --------------- | ------------- |
| dev\*       | 256         | 512 MB         | 256          | 512 MB          | 1             |
| qa\*        | 256         | 512 MB         | 256          | 512 MB          | 1             |
| staging\*   | 512         | 1024 MB        | 256          | 512 MB          | 1             |
| prod\*      | 1024        | 2048 MB        | 512          | 1024 MB         | 2             |

### **Database Configuration**

| Environment | Instance Class | Multi-AZ | Storage |
| ----------- | -------------- | -------- | ------- |
| dev\*       | db.t3.micro    | No       | 20 GB   |
| qa\*        | db.t3.micro    | No       | 20 GB   |
| staging\*   | db.t3.micro    | No       | 20 GB   |
| prod\*      | db.t3.small    | Yes      | 20 GB   |

---

## ‚ö†Ô∏è **Important Notes**

### **URL Characteristics**

- ‚úÖ **HTTP only** (no HTTPS on direct ALB URLs)
- ‚úÖ **Available immediately** after Terraform deployment
- ‚úÖ **No DNS propagation** required
- ‚úÖ **Random suffix** for uniqueness
- ‚ö†Ô∏è **Port 3000** required for frontend access

### **Security**

- üîí **Private subnets** for ECS tasks
- üîí **Security groups** restrict access
- üîí **IAM roles** for service permissions
- üîí **Secrets Manager** for sensitive data

### **Monitoring**

- üìä **CloudWatch Logs** for application logs
- üìä **ALB Access Logs** for traffic monitoring
- üìä **ECS Service Metrics** for performance
- üìä **RDS Performance Insights** for database monitoring

---

## üöÄ **Quick Access Commands**

### **Test Backend Health**

```bash
curl -f http://hibiji-dev01-alb-{suffix}.us-west-1.elb.amazonaws.com/health
```

### **Test Frontend**

```bash
curl -f http://hibiji-dev01-alb-{suffix}.us-west-1.elb.amazonaws.com:3000/
```

### **Get Service Status**

```bash
aws ecs describe-services \
  --cluster hibiji-dev01-cluster \
  --services hibiji-dev01-backend hibiji-dev01-frontend \
  --region us-west-1
```

---

## üìû **Troubleshooting**

### **Common Issues**

1. **Service not responding**: Check ECS service status
2. **Health check failing**: Check application logs in CloudWatch
3. **Port access issues**: Verify security group rules
4. **DNS not resolving**: Use direct ALB URLs instead

### **Useful Commands**

```bash
# Check ECS service status
aws ecs describe-services --cluster hibiji-{env}-cluster --services hibiji-{env}-backend --region us-west-1

# View application logs
aws logs tail /ecs/hibiji-{env}-app --region us-west-1 --follow

# Check ALB target health
aws elbv2 describe-target-health --target-group-arn {target-group-arn} --region us-west-1
```

---

**Last Updated**: July 2025  
**Terraform Version**: 1.8.5  
**AWS Region**: us-west-1
